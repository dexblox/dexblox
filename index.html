<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Topup Robux - Dexblox</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      margin:0;
      font-family:'Poppins',sans-serif;
      background:#fff; /* background putih */
      color:#000;
      overflow:auto;
    }
    header, footer {
      background:rgba(0,0,0,0.8);
      padding:15px;
      text-align:center;
      border-bottom:2px solid #000;
    }
    header h1, footer p {
      margin:0;
      font-size:18px;
      font-weight:600;
      color:#fff;
    }
    .container {max-width:95%;margin:20px auto;padding:15px;}
    .panel {
      margin:15px auto;
      padding:12px;
      border-radius:10px;
      background:transparent; /* panel transparan */
      border:1px solid #000;
      max-width:95%;
    }
    .panel h3 {
      margin:0 0 10px;
      font-size:15px;
      text-align:center;
      font-weight:600;
      color:#000;
    }
    input,button {
      width:90%;
      max-width:260px;
      padding:8px;
      font-size:13px;
      border-radius:8px;
      margin:6px auto;
      display:block;
      border:1px solid #000;
      background:transparent;
      color:#000;
      font-weight:600;
      transition:all 0.3s ease;
    }
    button:hover {
      transform:scale(1.05);
      box-shadow:0 0 12px #000;
      background:rgba(0,0,0,0.1);
    }
    .qris {
      width:100%;
      border:1px solid #000;
      border-radius:8px;
    }
    .info {
      margin-top:6px;
      font-size:12px;
      color:#000;
      text-align:center;
      font-weight:bold;
    }
    #particles {
      position:fixed;
      top:0;left:0;
      width:100%;height:100%;
      pointer-events:none;
      z-index:0;
    }
  </style>
</head>
<body>
  <canvas id="particles"></canvas>
  <header>
    <h1>üíé Topup Robux - Dexblox</h1>
  </header>

  <main class="container">
    <!-- Username Panel -->
    <section class="panel">
      <h3>üë§ Username Roblox</h3>
      <input type="text" id="username" placeholder="Masukkan Username Roblox">
      <button onclick="cekUsername()">üîç Cek Username</button>
      <div id="userInfo"></div>
      <div id="avatar"></div>
    </section>

    <!-- Game Panel -->
    <section class="panel">
      <h3>üéÆ Cek Game Roblox</h3>
      <input type="text" id="gameId" placeholder="Masukkan Game ID">
      <button onclick="cekGame(document.getElementById('gameId').value)">üîç Cek Game</button>
      <div id="gameInfo"></div>
    </section>

    <!-- Paket Robux -->
    <section class="panel">
      <h3>‚ö° Pilihan Paket Robux</h3>
      <div class="quick-prices">
        <button onclick="pilihPaket(100,'143')">100 RBX</button>
        <button onclick="pilihPaket(300,'429')">300 RBX</button>
        <button onclick="pilihPaket(500,'715')">500 RBX</button>
        <button onclick="pilihPaket(1000,'1430')">1000 RBX</button>
        <button onclick="pilihPaket(2000,'2860')">2000 RBX</button>
        <button onclick="pilihPaket(5000,'7150')">5000 RBX</button>
      </div>
    </section>

    <!-- Jumlah Manual -->
    <section class="panel">
      <h3>üí∞ Jumlah Robux Manual</h3>
      <input type="number" id="jumlahRobux" oninput="hitungManual()">
      <p class="info">Harga: Rp<span id="hargaPer100">11000</span> / 100 RBX</p>
      <p class="info" id="gamepassInfo">Gamepass: -</p>
      <input type="text" id="totalRp" readonly>
    </section>

    <!-- QRIS -->
    <section class="panel">
      <h3>üí≥ Pembayaran QRIS</h3>
      <img src="/qris.png" alt="QRIS Dexblox" class="qris">
    </section>

    <!-- Konfirmasi -->
    <section class="panel">
      <h3>üöÄ Konfirmasi Pembelian</h3>
      <button onclick="konfirmasiWA()">Lanjutkan Pembelian</button>
      <div id="topupNotif" style="display:none;">‚úÖ Topup kamu sedang diproses!</div>
      <div id="notifError" style="display:none;">‚ùå Lengkapi Username dan Jumlah Robux!</div>
      <div id="notifConfirm" style="display:none;">
        ‚ö†Ô∏è Apakah Username <span id="confirmUser"></span> dan Jumlah Robux <span id="confirmRobux"></span> sudah benar?
        <br><br>
        <button onclick="lanjutkanWA()">‚úÖ Ya, lanjutkan</button>
        <button onclick="batalConfirm()">‚ùå Batal</button>
      </div>
    </section>

    <!-- Admin Panel -->
    <section class="panel">
      <h3>üîë Admin Panel</h3>
      <input type="password" id="adminPass" placeholder="Kode admin">
      <button onclick="adminLogin()">Login</button>
      <p id="adminResult"></p>
      <div id="adminPanel" style="display:none;">
        <label for="newPrice">Harga/100 Robux:</label>
        <input type="number" id="newPrice" placeholder="11000">
        <button onclick="updatePrice()">Update</button>
      </div>
    </section>
  </main>

  <footer>
    <p>¬© 2026 Dexblox.ID ‚Äì Semua Hak Cipta</p>
  </footer>

  <!-- Script API -->
  <script src="/api/user.js"></script>
  <script src="/api/avatar.js"></script>
  <script src="/api/games.js"></script>

  <!-- Script Logika Harga, WA, Admin, Partikel -->
  <script>
    function pilihPaket(robux, gamepassId) {
      const hargaPer100 = parseInt(document.getElementById('hargaPer100').innerText.replace(/\./g,''));
      const harga = (robux / 100) * hargaPer100;
      document.getElementById('jumlahRobux').value = robux;
      document.getElementById('totalRp').value = `Rp${harga.toLocaleString()}`;
      document.getElementById('gamepassInfo').innerText = `Gamepass: ${gamepassId}`;
    }

    function hitungManual() {
      const robux = parseInt(document.getElementById('jumlahRobux').value);
      if (!robux) {
        document.getElementById('totalRp').value = "";
        document.getElementById('gamepassInfo').innerText = "Gamepass: -";
        return;
      }
      const hargaPer100 = parseInt(document.getElementById('hargaPer100').innerText.replace(/\./g,''));
      const harga = (robux / 100) * hargaPer100;
      document.getElementById('totalRp').value = `Rp${harga.toLocaleString()}`;
      document.getElementById('gamepassInfo').innerText = `Gamepass: ${robux}`;
    }

    function konfirmasiWA() {
      const username = document.getElementById('username').value.trim();
      const robux = document.getElementById('jumlahRobux').value;
      if (!username || !robux) {
        document.getElementById('notifError').style.display = "block";
        setTimeout(() => { document.getElementById('notifError').style.display = "none"; }, 4000);
        return;
      }
      document.getElementById('confirmUser').innerText = username;
      document.getElementById('confirmRobux').innerText = robux;
      document.getElementById('notifConfirm').style.display = "block";
    }

    function batalConfirm() {
      document.getElementById('notifConfirm').style.display = "none";
    }

    function lanjutkanWA() {
      document.getElementById('notifConfirm').style.display = "none";
      const username = document.getElementById('username').value.trim();
      const robux = document.getElementById('jumlahRobux').value;
      const total = document.getElementById('totalRp').value;
      const gamepass = document.getElementById('gamepassInfo').innerText;
      const profileLinkEl = document.getElementById('userInfo').querySelector("a[href*='roblox.com/users']");
      const profileLink = profileLinkEl ? profileLinkEl.href : "";

      const message = `Halo Admin Dexblox,\nTopup ${robux} Robux (${total}) untuk ${username}.\n${gamepass}\nProfil User: ${profileLink}\nPembayaran via QRIS. Bukti pembayaran sudah dikirim user.`;
      const waUrl = `https://wa.me/6285362187740?text=${encodeURIComponent(message)}`;
      window.open(waUrl, "_blank");

      document.getElementById('topupNotif').style.display = "block";
      setTimeout(() => { document.getElementById('topupNotif').style.display = "none"; }, 5000);
    }

    function adminLogin() {
      const pass = document.getElementById('adminPass').value;
      const result = document.getElementById('adminResult');
      if (pass === "dexblox123") {
        result.innerText = "‚úÖ Login sukses!";
        document.getElementById('adminPanel').style.display = "block";
      } else {
        result.innerText = "‚ùå Kode salah!";
      }
    }

    function updatePrice() {
      const newPrice = document.getElementById('newPrice').value;
      if (!newPrice) return;
      localStorage.setItem("hargaPer100", newPrice);
      document.getElementById('hargaPer100').innerText = parseInt(newPrice).toLocaleString();
      alert("‚úÖ Harga berhasil diupdate!");
      hitungManual();
    }

    // üåü Background Partikel Merah Bergerak
    const canvasParticles = document.getElementById("particles");
    const ctxP = canvasParticles.getContext("2d");
    canvasParticles.width = window.innerWidth;
    canvasParticles.height = window.innerHeight;
    let particlesArray = [];

    function initParticles() {
      for (let i = 0; i < 80; i++) {
        particlesArray.push({
          x: Math.random() * canvasParticles.width,
          y: Math.random() * canvasParticles.height,
          radius: Math.random() * 2 + 1,
          dx: (Math.random() - 0.5) * 0.5,
          dy: (Math.random() - 0.5) * 0.5
        });
      }
    }

    function drawParticles() {
      ctxP.clearRect(0, 0, canvasParticles.width, canvasParticles.height);
      ctxP.fillStyle = "rgba(255,0,0,0.6)";
      ctxP.beginPath();
      particlesArray.forEach(p => {
        ctxP.moveTo(p.x, p.y);
        ctxP.arc(p.x, p.y, p.radius, 0, Math.PI * 2);
      });
      ctxP.fill();
      moveParticles();
    }

    function moveParticles() {
      particlesArray.forEach(p => {
        p.x += p.dx;
        p.y += p.dy;
        if (p.x < 0 || p.x > canvasParticles.width) p.dx *= -1;
        if (p.y < 0 || p.y > canvasParticles.height) p.dy *= -1;
      });
    }

    initParticles();
    setInterval(drawParticles, 30);
  </script>
</body>
</html>
