<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>DEXBLOX â€” Topup Robux Terpercaya</title>
<style>
:root{
  --blue:#1565C0;--blue2:#1976D2;--blue3:#E3F0FF;
  --red:#C62828;--orange:#E65100;--yellow:#F9A825;
  --green:#1B5E20;--green2:#E8F5E9;
  --gold:#B8860B;--gold2:#FFF8DC;
  --g50:#F8FAFC;--g100:#F1F5F9;--g200:#E2E8F0;--g300:#CBD5E1;
  --g400:#94A3B8;--g500:#64748B;--g700:#334155;--g900:#0F172A;
  --white:#FFF;
  --sh0:0 1px 3px rgba(0,0,0,0.07);
  --sh1:0 4px 16px rgba(0,0,0,0.08);
  --sh2:0 12px 40px rgba(0,0,0,0.12);
  --r:12px;--rs:8px;--rl:16px;
}
*{margin:0;padding:0;box-sizing:border-box;}
body{background:var(--g50);color:var(--g900);font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Arial,sans-serif;font-size:14px;min-height:100vh;}

/* â”€â”€â”€ TOPBAR â”€â”€â”€ */
.topbar{background:var(--white);border-bottom:1px solid var(--g200);position:sticky;top:0;z-index:200;box-shadow:var(--sh0);}
.topbar-inner{max-width:600px;margin:0 auto;height:54px;display:flex;align-items:center;justify-content:space-between;padding:0 16px;}
.logo{font-size:1.3rem;font-weight:900;color:var(--blue);letter-spacing:-0.5px;display:flex;align-items:center;gap:4px;}
.logo-dot{color:var(--red);}
.topbar-actions{display:flex;align-items:center;gap:6px;}
.dot-live{display:flex;align-items:center;gap:5px;font-size:0.7rem;font-weight:700;color:#92400E;background:#FEF3C7;border:1px solid #FDE68A;padding:3px 10px;border-radius:20px;}
.dot-live i{width:6px;height:6px;background:#EF4444;border-radius:50%;animation:blink 1.2s ease-in-out infinite;}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.2}}
.btn-pill{background:var(--blue3);color:var(--blue);border:none;padding:6px 13px;border-radius:20px;font-size:0.75rem;font-weight:700;cursor:pointer;transition:.2s;}
.btn-pill:hover{background:#C7D9F7;}

/* â”€â”€â”€ WRAP â”€â”€â”€ */
.wrap{max-width:600px;margin:0 auto;padding:14px 14px 40px;}

/* â”€â”€â”€ HERO â”€â”€â”€ */
.hero{background:linear-gradient(130deg,#1565C0 0%,#1A237E 100%);border-radius:var(--rl);padding:22px 18px;margin-bottom:14px;color:#fff;position:relative;overflow:hidden;}
.hero::before{content:'';position:absolute;top:-30px;right:-30px;width:140px;height:140px;background:rgba(255,255,255,0.05);border-radius:50%;}
.hero::after{content:'';position:absolute;bottom:-20px;right:20px;width:80px;height:80px;background:rgba(255,255,255,0.04);border-radius:50%;}
.hero-top{display:flex;align-items:center;gap:14px;margin-bottom:14px;}
.hero-icon{width:52px;height:52px;background:rgba(255,255,255,0.15);border-radius:13px;display:flex;align-items:center;justify-content:center;font-size:1.7rem;flex-shrink:0;backdrop-filter:blur(6px);}
.hero-title h1{font-size:1.2rem;font-weight:800;margin-bottom:3px;letter-spacing:-.3px;}
.hero-title p{font-size:0.78rem;opacity:.8;}
.hero-stats{display:flex;gap:0;border-top:1px solid rgba(255,255,255,0.12);padding-top:14px;}
.hs{flex:1;text-align:center;border-right:1px solid rgba(255,255,255,0.12);}
.hs:last-child{border-right:none;}
.hs-num{font-size:1.05rem;font-weight:800;}
.hs-lbl{font-size:0.65rem;opacity:.65;text-transform:uppercase;letter-spacing:.5px;}

/* â”€â”€â”€ TRUST â”€â”€â”€ */
.trust{display:flex;gap:7px;overflow-x:auto;padding-bottom:2px;margin-bottom:14px;}
.trust::-webkit-scrollbar{display:none;}
.trust-chip{display:flex;align-items:center;gap:5px;background:var(--white);border:1px solid var(--g200);border-radius:20px;padding:5px 11px;white-space:nowrap;font-size:0.72rem;font-weight:600;color:var(--g700);box-shadow:var(--sh0);}

/* â”€â”€â”€ TABS â”€â”€â”€ */
.tabs{background:var(--white);border-radius:var(--r);padding:4px;display:flex;gap:4px;margin-bottom:14px;box-shadow:var(--sh0);}
.tab{flex:1;padding:9px 6px;border-radius:var(--rs);border:none;background:transparent;color:var(--g400);font-size:0.8rem;font-weight:600;cursor:pointer;transition:.18s;white-space:nowrap;}
.tab.on{background:var(--blue);color:#fff;box-shadow:0 2px 8px rgba(21,101,192,.3);}
.tab:hover:not(.on){background:var(--g100);color:var(--g700);}

/* â”€â”€â”€ CARD â”€â”€â”€ */
.card{background:var(--white);border-radius:var(--rl);box-shadow:var(--sh1);margin-bottom:14px;overflow:hidden;}
.card.off{display:none;}
.c-head{padding:15px 18px 11px;border-bottom:1px solid var(--g100);}
.c-head h2{font-size:0.92rem;font-weight:700;}
.c-head p{font-size:0.75rem;color:var(--g500);margin-top:2px;}
.c-body{padding:16px 18px;}

/* â”€â”€â”€ ALERT BOX â”€â”€â”€ */
.abox{border-radius:var(--rs);padding:10px 13px;margin-bottom:14px;font-size:0.8rem;line-height:1.6;display:flex;gap:9px;}
.abox-warn{background:#FFFBEB;border:1px solid #FDE68A;color:#78350F;}
.abox-info{background:#EFF6FF;border:1px solid #BFDBFE;color:#1E3A8A;}
.abox-em{flex-shrink:0;}

/* â”€â”€â”€ FORM â”€â”€â”€ */
.frow{margin-bottom:13px;}
.flabel{display:block;font-size:0.72rem;font-weight:700;color:var(--g500);text-transform:uppercase;letter-spacing:.5px;margin-bottom:5px;}
.finput{width:100%;border:1.5px solid var(--g200);border-radius:var(--rs);padding:10px 13px;font-size:0.88rem;color:var(--g900);background:var(--white);outline:none;transition:.18s;-webkit-appearance:none;}
.finput:focus{border-color:var(--blue);box-shadow:0 0 0 3px rgba(21,101,192,.1);}
.finput::placeholder{color:var(--g300);}
.fhint{font-size:0.7rem;color:var(--g400);margin-top:3px;}
.ntf{font-size:0.73rem;margin-top:4px;min-height:17px;font-weight:600;}
.ntf.ok{color:var(--green);}
.ntf.er{color:var(--red);}

/* â”€â”€â”€ USERNAME CHECK AREA â”€â”€â”€ */
.user-search-row{display:flex;gap:8px;align-items:flex-end;}
.user-search-row .finput{flex:1;}
.btn-cek-user{background:var(--blue);color:#fff;border:none;padding:10px 16px;border-radius:var(--rs);font-size:0.82rem;font-weight:700;cursor:pointer;transition:.2s;white-space:nowrap;flex-shrink:0;}
.btn-cek-user:hover{background:var(--blue2);}
.btn-cek-user:disabled{background:var(--g300);cursor:not-allowed;}

/* â”€â”€â”€ AVATAR RESULT â”€â”€â”€ */
.avatar-result{display:none;align-items:center;gap:12px;background:var(--g50);border:1px solid var(--g200);border-radius:var(--rs);padding:12px 14px;margin-top:8px;}
.avatar-result img{width:56px;height:56px;border-radius:50%;border:2.5px solid var(--blue);flex-shrink:0;object-fit:cover;}
.av-info{flex:1;}
.av-name{font-size:0.9rem;font-weight:700;color:var(--g900);}
.av-sub{font-size:0.72rem;color:var(--g500);margin-top:1px;}
.av-badge{display:inline-flex;align-items:center;gap:4px;background:var(--green2);color:var(--green);font-size:0.68rem;font-weight:700;padding:2px 8px;border-radius:20px;margin-top:4px;}

/* â”€â”€â”€ LOADING SKELETON â”€â”€â”€ */
.av-skeleton{display:none;align-items:center;gap:12px;background:var(--g50);border:1px solid var(--g200);border-radius:var(--rs);padding:12px 14px;margin-top:8px;}
.sk-circle{width:56px;height:56px;border-radius:50%;background:linear-gradient(90deg,var(--g200) 25%,var(--g100) 50%,var(--g200) 75%);background-size:200% 100%;animation:shimmer 1.2s infinite;flex-shrink:0;}
.sk-lines{flex:1;}
.sk-line{height:10px;border-radius:4px;background:linear-gradient(90deg,var(--g200) 25%,var(--g100) 50%,var(--g200) 75%);background-size:200% 100%;animation:shimmer 1.2s infinite;margin-bottom:6px;}
.sk-line.w80{width:80%;}
.sk-line.w50{width:50%;}
@keyframes shimmer{0%{background-position:200% 0}100%{background-position:-200% 0}}

/* â”€â”€â”€ HARGA BOX â”€â”€â”€ */
.harga-box{background:linear-gradient(135deg,#FFFDE7,#FFF8E1);border:1px solid #FFE082;border-radius:var(--rs);padding:11px 14px;display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;}
.harga-val{font-size:1.25rem;font-weight:800;color:var(--orange);}
.harga-val small{font-size:0.68rem;color:#8D6E63;font-weight:600;margin-left:3px;}
.harga-tag{background:#FFB300;color:#fff;font-size:0.68rem;font-weight:700;padding:3px 10px;border-radius:20px;}

/* â”€â”€â”€ SECTION LABEL â”€â”€â”€ */
.slbl{font-size:0.7rem;font-weight:700;text-transform:uppercase;letter-spacing:.5px;color:var(--g400);margin-bottom:7px;}
.slbl-accent{font-size:0.73rem;font-weight:700;text-transform:uppercase;letter-spacing:.5px;color:var(--orange);margin:14px 0 7px;display:flex;align-items:center;gap:5px;}

/* â”€â”€â”€ PAKET GRID â”€â”€â”€ */
.pgrid{display:grid;grid-template-columns:1fr 1fr;gap:7px;margin-bottom:7px;}
.pcard{background:var(--g50);border:1.5px solid var(--g200);border-radius:var(--rs);padding:11px 10px;cursor:pointer;text-align:center;transition:.18s;position:relative;}
.pcard:hover{border-color:var(--blue);background:var(--blue3);}
.pcard.on{border-color:var(--blue);background:var(--blue3);box-shadow:0 0 0 2px rgba(21,101,192,.12);}
.pcard-rbx{font-size:0.9rem;font-weight:800;color:var(--g900);}
.pcard-price{font-size:0.75rem;color:var(--g500);margin-top:2px;}
.pcard.on .pcard-rbx,.pcard.on .pcard-price{color:var(--blue);}
.pcard-hot::after{content:'Populer';position:absolute;top:-1px;right:-1px;background:var(--orange);color:#fff;font-size:0.58rem;font-weight:700;padding:2px 7px;border-radius:0 var(--rs) 0 var(--rs);}

/* â”€â”€â”€ PAKET RESULT â”€â”€â”€ */
.presult{background:var(--blue3);border:1px solid #C7D9F7;border-radius:var(--rs);padding:10px 13px;margin:9px 0;}
.presult .pr-lbl{font-size:0.68rem;color:#3B5BDB;font-weight:600;margin-bottom:2px;}
.presult .pr-val{font-size:0.88rem;font-weight:700;color:var(--blue);}

/* â”€â”€â”€ PROMO ROW â”€â”€â”€ */
.promo-row{display:flex;gap:7px;}
.promo-row .finput{flex:1;}
.btn-promo{background:var(--blue);color:#fff;border:none;padding:0 15px;border-radius:var(--rs);font-weight:700;font-size:0.8rem;cursor:pointer;white-space:nowrap;}
.btn-promo:hover{background:var(--blue2);}

/* â”€â”€â”€ SUBMIT â”€â”€â”€ */
.btn-go{width:100%;padding:13px;background:var(--blue);color:#fff;border:none;border-radius:var(--rs);font-size:0.9rem;font-weight:700;cursor:pointer;transition:.2s;margin-top:12px;letter-spacing:.2px;}
.btn-go:hover{background:var(--blue2);box-shadow:0 6px 18px rgba(21,101,192,.3);transform:translateY(-1px);}
.btn-go:active{transform:none;}

/* â”€â”€â”€ TOP RANK â”€â”€â”€ */
.rank-card{background:var(--white);border-radius:var(--rl);box-shadow:var(--sh1);margin-bottom:14px;overflow:hidden;}
.rank-head{background:linear-gradient(130deg,#1565C0,#1A237E);padding:14px 18px;color:#fff;}
.rank-head h3{font-size:0.9rem;font-weight:800;display:flex;align-items:center;gap:7px;}
.rank-head p{font-size:0.72rem;opacity:.75;margin-top:2px;}
.rank-list{padding:8px 0;}
.rank-item{display:flex;align-items:center;gap:12px;padding:10px 18px;border-bottom:1px solid var(--g100);transition:.15s;}
.rank-item:last-child{border-bottom:none;}
.rank-item:hover{background:var(--g50);}
.rank-num{width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:0.8rem;font-weight:800;flex-shrink:0;}
.rn-1{background:linear-gradient(135deg,#FFD700,#FFA500);color:#fff;}
.rn-2{background:linear-gradient(135deg,#C0C0C0,#A8A8A8);color:#fff;}
.rn-3{background:linear-gradient(135deg,#CD7F32,#A0522D);color:#fff;}
.rn-other{background:var(--g100);color:var(--g500);}
.rank-av{width:42px;height:42px;border-radius:50%;object-fit:cover;border:2px solid var(--g200);flex-shrink:0;background:var(--g100);}
.rank-av-skel{width:42px;height:42px;border-radius:50%;background:linear-gradient(90deg,var(--g200) 25%,var(--g100) 50%,var(--g200) 75%);background-size:200% 100%;animation:shimmer 1.2s infinite;flex-shrink:0;}
.rank-info{flex:1;min-width:0;}
.rank-name{font-size:0.88rem;font-weight:700;color:var(--g900);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.rank-sub{font-size:0.7rem;color:var(--g400);margin-top:1px;}
.rank-robux{font-size:0.82rem;font-weight:700;color:var(--blue);white-space:nowrap;}

/* â”€â”€â”€ TESTIMONIAL â”€â”€â”€ */
.testi-grid{display:grid;grid-template-columns:1fr 1fr;gap:9px;}
.tcard{background:var(--white);border:1px solid var(--g200);border-radius:var(--r);padding:13px;box-shadow:var(--sh0);}
.tcard-stars{color:#F59E0B;font-size:0.7rem;margin-bottom:5px;}
.tcard-text{font-size:0.78rem;color:var(--g700);line-height:1.5;margin-bottom:9px;}
.tcard-user{display:flex;align-items:center;gap:8px;}
.tcard-av{width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:0.8rem;font-weight:700;color:#fff;flex-shrink:0;}
.tcard-name{font-size:0.78rem;font-weight:700;}
.tcard-pkg{font-size:0.68rem;color:var(--g400);}

/* â”€â”€â”€ MODAL OVERLAY â”€â”€â”€ */
.modal{display:none;position:fixed;inset:0;background:rgba(15,23,42,.5);backdrop-filter:blur(4px);z-index:300;align-items:flex-end;justify-content:center;}
.modal.on{display:flex;}
@media(min-width:480px){.modal{align-items:center;padding:20px;}}
.msheet{background:var(--white);border-radius:20px 20px 0 0;width:100%;max-width:540px;max-height:91vh;overflow-y:auto;}
@media(min-width:480px){.msheet{border-radius:var(--rl);}}
.mhandle{width:34px;height:4px;background:var(--g200);border-radius:2px;margin:10px auto;}
.mhead{padding:14px 18px 11px;border-bottom:1px solid var(--g100);display:flex;align-items:center;justify-content:space-between;}
.mhead h3{font-size:0.95rem;font-weight:700;}
.mbtn-x{width:28px;height:28px;border-radius:50%;background:var(--g100);border:none;cursor:pointer;font-size:0.85rem;display:flex;align-items:center;justify-content:center;color:var(--g500);}
.mbtn-x:hover{background:var(--g200);}
.mbody{padding:16px 18px 28px;}

/* â”€â”€â”€ ORDER ID BOX â”€â”€â”€ */
.oid-box{background:linear-gradient(130deg,var(--blue),#1A237E);border-radius:var(--r);padding:14px 16px;color:#fff;margin-bottom:14px;text-align:center;}
.oid-lbl{font-size:0.68rem;opacity:.75;text-transform:uppercase;letter-spacing:1px;margin-bottom:4px;}
.oid-code{font-size:1.1rem;font-weight:800;letter-spacing:2.5px;font-family:monospace;}
.oid-copy{margin-top:8px;background:rgba(255,255,255,.15);border:1px solid rgba(255,255,255,.25);color:#fff;padding:4px 14px;border-radius:20px;font-size:0.7rem;font-weight:700;cursor:pointer;transition:.2s;}
.oid-copy:hover{background:rgba(255,255,255,.25);}

/* â”€â”€â”€ ORDER SUMMARY â”€â”€â”€ */
.osum{background:var(--g50);border:1px solid var(--g200);border-radius:var(--r);margin-bottom:14px;overflow:hidden;}
.osum-row{display:flex;justify-content:space-between;align-items:center;padding:9px 14px;border-bottom:1px solid var(--g100);}
.osum-row:last-child{border-bottom:none;background:var(--blue3);padding:11px 14px;}
.os-l{font-size:0.78rem;color:var(--g500);}
.os-r{font-size:0.82rem;font-weight:700;color:var(--g900);}
.os-r.blue{color:var(--blue);}
.os-r.fee{color:var(--orange);}
.os-r.total{font-size:0.95rem;color:var(--blue);}

/* â”€â”€â”€ QRIS â”€â”€â”€ */
.qris-wrap{text-align:center;margin-bottom:14px;}
.qris-wrap h4{font-size:0.8rem;font-weight:700;color:var(--g700);margin-bottom:10px;}
.qris-frame{display:inline-block;padding:10px;background:var(--white);border:1.5px solid var(--g200);border-radius:var(--r);box-shadow:var(--sh0);}
.qris-frame img{width:170px;height:170px;border-radius:4px;display:block;}
.qris-apps{display:flex;justify-content:center;gap:6px;margin-top:9px;flex-wrap:wrap;}
.qapp{background:var(--g100);border:1px solid var(--g200);border-radius:20px;padding:3px 11px;font-size:0.7rem;font-weight:600;color:var(--g700);}
.due-box{background:linear-gradient(135deg,#FFFDE7,#FFF8E1);border:1px solid #FFE082;border-radius:var(--rs);padding:12px 14px;text-align:center;margin:11px 0;}
.due-lbl{font-size:0.7rem;color:#8D6E63;font-weight:600;margin-bottom:3px;}
.due-amt{font-size:1.55rem;font-weight:800;color:var(--orange);}
.due-note{font-size:0.68rem;color:#A1887F;margin-top:3px;}

/* â”€â”€â”€ UPLOAD â”€â”€â”€ */
.upload-zone{border:1.5px dashed var(--g300);border-radius:var(--rs);padding:15px;text-align:center;cursor:pointer;transition:.2s;background:var(--g50);margin-bottom:11px;}
.upload-zone:hover,.upload-zone:focus-within{border-color:var(--blue);background:var(--blue3);}
.upload-zone input{display:none;}
.uz-ico{font-size:1.3rem;margin-bottom:4px;}
.uz-txt{font-size:0.78rem;font-weight:600;color:var(--g700);}
.uz-sub{font-size:0.68rem;color:var(--g400);}
#uploadPreview{width:100%;border-radius:var(--rs);margin-bottom:11px;display:none;}

/* â”€â”€â”€ ACTION BTNS â”€â”€â”€ */
.act-btns{display:grid;grid-template-columns:1fr 1fr;gap:9px;}
.btn-wa{background:var(--blue);color:#fff;border:none;padding:12px;border-radius:var(--rs);font-size:0.86rem;font-weight:700;cursor:pointer;transition:.2s;}
.btn-wa:hover{background:var(--blue2);box-shadow:0 4px 14px rgba(21,101,192,.3);}
.btn-cancel2{background:var(--g100);color:var(--g700);border:1px solid var(--g200);padding:12px;border-radius:var(--rs);font-size:0.86rem;font-weight:700;cursor:pointer;}
.btn-cancel2:hover{background:var(--g200);}

/* â”€â”€â”€ TRACK MODAL â”€â”€â”€ */
.track-row{display:flex;gap:7px;margin-bottom:14px;}
.track-row .finput{flex:1;}
.btn-track{background:var(--blue);color:#fff;border:none;padding:0 15px;border-radius:var(--rs);font-weight:700;cursor:pointer;font-size:0.8rem;}
.track-res{display:none;margin-bottom:14px;}
.oc{background:var(--g50);border:1.5px solid var(--g200);border-radius:var(--r);padding:14px;}
.oc-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;}
.oc-id{font-size:0.8rem;font-weight:800;color:var(--blue);font-family:monospace;}
.sbadge{padding:3px 10px;border-radius:20px;font-size:0.68rem;font-weight:700;}
.sp{background:#FEF3C7;color:#92400E;}
.sd{background:#D1FAE5;color:#065F46;}
.ss{background:var(--blue3);color:#1E3A8A;}
.sc{background:#FEE2E2;color:#991B1B;}
.ocd-row{display:flex;justify-content:space-between;padding:5px 0;border-bottom:1px solid var(--g100);font-size:0.79rem;}
.ocd-row:last-child{border-bottom:none;}
.ocd-k{color:var(--g500);}
.ocd-v{font-weight:700;}
.no-ord{text-align:center;padding:28px 0;color:var(--g400);}
.no-ord .ni{font-size:1.8rem;margin-bottom:7px;}
.recv-title{font-size:0.7rem;font-weight:700;text-transform:uppercase;letter-spacing:.5px;color:var(--g400);margin-bottom:7px;}
.olist{display:flex;flex-direction:column;gap:6px;}
.oitem{background:var(--g50);border:1px solid var(--g200);border-radius:var(--rs);padding:10px 12px;cursor:pointer;transition:.15s;}
.oitem:hover{border-color:var(--blue);background:var(--blue3);}
.oitem-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:2px;}
.oi-id{font-size:0.76rem;font-weight:700;color:var(--blue);font-family:monospace;}
.oi-desc{font-size:0.76rem;color:var(--g700);}
.oi-t{font-size:0.68rem;color:var(--g400);}

/* â”€â”€â”€ ADMIN â”€â”€â”€ */
.admin-modal{display:none;position:fixed;inset:0;background:rgba(15,23,42,.5);backdrop-filter:blur(4px);z-index:400;align-items:center;justify-content:center;padding:20px;}
.admin-modal.on{display:flex;}
.admin-box{background:var(--white);border-radius:var(--rl);padding:22px 18px;width:100%;max-width:390px;max-height:90vh;overflow-y:auto;box-shadow:var(--sh2);}
.admin-hd{display:flex;align-items:center;gap:10px;margin-bottom:16px;padding-bottom:14px;border-bottom:1px solid var(--g100);}
.admin-hd-icon{width:36px;height:36px;background:var(--blue3);border-radius:var(--rs);display:flex;align-items:center;justify-content:center;font-size:1rem;}
.admin-hd h3{font-size:0.9rem;font-weight:700;flex:1;}
#adminTools{display:none;}
#adminTools.on{display:block;}
.divr{height:1px;background:var(--g100);margin:14px 0;}

/* â”€â”€â”€ FAB â”€â”€â”€ */
#fabAdmin{position:fixed;bottom:20px;right:16px;width:36px;height:36px;border-radius:50%;background:var(--white);border:1px solid var(--g200);color:var(--g400);font-size:0.95rem;cursor:pointer;z-index:99;box-shadow:var(--sh1);transition:.2s;}
#fabAdmin:hover{color:var(--blue);border-color:var(--blue);}

/* â”€â”€â”€ FOOTER â”€â”€â”€ */
footer{text-align:center;padding:20px 16px;color:var(--g400);font-size:0.72rem;border-top:1px solid var(--g200);background:var(--white);}
.f-logo{font-size:0.9rem;font-weight:900;color:var(--blue);margin-bottom:3px;}
.f-logo span{color:var(--red);}

/* â”€â”€â”€ SPINNER & TOAST â”€â”€â”€ */
.spin{display:inline-block;width:11px;height:11px;border:2px solid rgba(21,101,192,.2);border-top-color:var(--blue);border-radius:50%;animation:rot .6s linear infinite;vertical-align:middle;margin-left:4px;}
@keyframes rot{to{transform:rotate(360deg)}}
.toast{position:fixed;bottom:22px;left:50%;transform:translateX(-50%) translateY(70px);background:var(--g900);color:#fff;padding:9px 18px;border-radius:20px;font-size:0.8rem;font-weight:600;z-index:999;transition:.3s ease;white-space:nowrap;box-shadow:var(--sh2);}
.toast.on{transform:translateX(-50%) translateY(0);}

@media(max-width:360px){.testi-grid{grid-template-columns:1fr;}}
</style>
</head>
<body>

<!-- TOPBAR -->
<div class="topbar">
  <div class="topbar-inner">
    <div class="logo">DEX<span class="logo-dot">BLOX</span></div>
    <div class="topbar-actions">
      <div class="dot-live"><i></i>ONLINE</div>
      <button class="btn-pill" onclick="openTrack()">ğŸ“¦ Cek Pesanan</button>
    </div>
  </div>
</div>

<div class="wrap">

  <!-- HERO -->
  <div class="hero">
    <div class="hero-top">
      <div class="hero-icon">ğŸ’</div>
      <div class="hero-title">
        <h1>Topup Robux Termurah</h1>
        <p>Proses otomatis Â· Aman Â· Terpercaya sejak 2022</p>
      </div>
    </div>
    <div class="hero-stats">
      <div class="hs"><div class="hs-num">50K+</div><div class="hs-lbl">Transaksi</div></div>
      <div class="hs"><div class="hs-num">4.9â˜…</div><div class="hs-lbl">Rating</div></div>
      <div class="hs"><div class="hs-num">&lt;5m</div><div class="hs-lbl">Proses</div></div>
      <div class="hs"><div class="hs-num">24/7</div><div class="hs-lbl">Support</div></div>
    </div>
  </div>

  <!-- TRUST -->
  <div class="trust">
    <div class="trust-chip">âœ… Anti Banned</div>
    <div class="trust-chip">ğŸ”’ Pembayaran Aman</div>
    <div class="trust-chip">âš¡ Proses Instan</div>
    <div class="trust-chip">ğŸ’¬ CS 24/7</div>
    <div class="trust-chip">ğŸ¯ 100% Berhasil</div>
  </div>

  <!-- TABS -->
  <div class="tabs">
    <button class="tab on" id="tab5hari" onclick="showPanel('panel5hari')">ğŸ’ 5 Hari</button>
    <button class="tab" id="tabLogin" onclick="showPanel('panelLogin')">ğŸ”‘ Via Login</button>
    <button class="tab" id="tabKomunitas" onclick="showPanel('panelKomunitas')">ğŸ‘¥ Komunitas</button>
  </div>

  <!-- â•â• PANEL 5 HARI â•â• -->
  <div class="card" id="panel5hari">
    <div class="c-head">
      <h2>Topup Robux 5 Hari</h2>
      <p>Via gamepass Â· Robux masuk dalam 5 hari kerja</p>
    </div>
    <div class="c-body">

      <div class="abox abox-warn"><span class="abox-em">âš ï¸</span><div>Pembelian via <strong>gamepass/private server</strong> berisiko banned jika dilakukan dalam jumlah besar. Penjual tidak bertanggung jawab atas konsekuensi pada akun.</div></div>

      <div class="frow">
        <label class="flabel">Username Roblox</label>
        <div class="user-search-row">
          <input class="finput" type="text" id="username" placeholder="Masukkan username..." autocomplete="off" spellcheck="false">
          <button class="btn-cek-user" id="btnCekUser">Cek</button>
        </div>
        <div class="ntf" id="notifUsername"></div>
        <!-- Skeleton -->
        <div class="av-skeleton" id="skel5hari">
          <div class="sk-circle"></div>
          <div class="sk-lines"><div class="sk-line w80"></div><div class="sk-line w50"></div></div>
        </div>
        <!-- Result -->
        <div class="avatar-result" id="avResult5hari">
          <img id="avatarPreview" src="" alt="">
          <div class="av-info">
            <div class="av-name" id="uname5hari"></div>
            <div class="av-sub" id="uid5hari"></div>
            <div class="av-badge">âœ“ Akun Ditemukan</div>
          </div>
        </div>
      </div>

      <div class="harga-box">
        <div>
          <div style="font-size:0.68rem;color:#8D6E63;font-weight:600;margin-bottom:2px;">Harga Hari Ini</div>
          <div class="harga-val">Rp <span id="hargaHariIni" data-harga="13000">13.000</span><small>= 100 Robux</small></div>
        </div>
        <div class="harga-tag">Live Update</div>
      </div>

      <div class="slbl">Pilih Paket</div>
      <div class="pgrid" id="grid5hari">
        <div class="pcard" data-value="100"><div class="pcard-rbx">100 Robux</div><div class="pcard-price">Rp 13.000</div></div>
        <div class="pcard" data-value="200"><div class="pcard-rbx">200 Robux</div><div class="pcard-price">Rp 26.000</div></div>
        <div class="pcard pcard-hot" data-value="500"><div class="pcard-rbx">500 Robux</div><div class="pcard-price">Rp 65.000</div></div>
        <div class="pcard" data-value="1000"><div class="pcard-rbx">1000 Robux</div><div class="pcard-price">Rp 130.000</div></div>
      </div>
      <div class="ntf" id="notifPaket"></div>

      <div class="frow" style="margin-top:12px;">
        <label class="flabel">Custom Jumlah Robux</label>
        <input class="finput" type="number" id="customRobux" placeholder="Min. 100 Robux" min="100">
        <div class="fhint">Harga dihitung otomatis berdasarkan kurs hari ini</div>
      </div>

      <div class="presult" id="paketInfo">
        <div class="pr-lbl">Rincian Paket</div>
        <div class="pr-val" id="paketInfoVal">â€” Pilih paket di atas â€”</div>
      </div>

      <div class="frow" style="margin-top:12px;">
        <label class="flabel">Kode Promo</label>
        <div class="promo-row">
          <input class="finput" type="text" id="promoInput" placeholder="Kode promo...">
          <button class="btn-promo" id="btnPromo">Pakai</button>
        </div>
        <div class="ntf" id="notifPromo"></div>
      </div>

      <button class="btn-go" id="btnTopup5hari">âš¡ Lanjutkan Pembayaran</button>
    </div>
  </div>

  <!-- â•â• PANEL LOGIN â•â• -->
  <div class="card off" id="panelLogin">
    <div class="c-head">
      <h2>Topup Via Login</h2>
      <p>Robux langsung masuk ke akun Â· Tanpa menunggu</p>
    </div>
    <div class="c-body">

      <div class="abox abox-info"><span class="abox-em">â„¹ï¸</span><div>Topup via login langsung masuk ke akun Roblox. Tetap <strong>online</strong> saat proses berlangsung. Disarankan <strong>nonaktifkan 2FA</strong> sementara.</div></div>

      <div class="frow">
        <label class="flabel">Username Roblox</label>
        <div class="user-search-row">
          <input class="finput" type="text" id="loginUsername" placeholder="Masukkan username..." autocomplete="off" spellcheck="false">
          <button class="btn-cek-user" id="btnLoginCekUser">Cek</button>
        </div>
        <div class="ntf" id="loginNotifUser"></div>
        <div class="av-skeleton" id="skelLogin">
          <div class="sk-circle"></div>
          <div class="sk-lines"><div class="sk-line w80"></div><div class="sk-line w50"></div></div>
        </div>
        <div class="avatar-result" id="avResultLogin">
          <img id="loginAvatar" src="" alt="">
          <div class="av-info">
            <div class="av-name" id="unameLogin"></div>
            <div class="av-sub" id="uidLogin"></div>
            <div class="av-badge">âœ“ Akun Ditemukan</div>
          </div>
        </div>
      </div>

      <div class="frow">
        <label class="flabel">Password Roblox</label>
        <input class="finput" type="password" id="loginPassword" placeholder="Password akun Roblox kamu" autocomplete="new-password">
        <div class="fhint">ğŸ”’ Password kamu dienkripsi & hanya digunakan untuk proses topup, kemudian dihapus.</div>
      </div>

      <div class="slbl-accent">ğŸ‘‘ Paket Premium</div>
      <div class="pgrid" id="gridLoginPremium">
        <div class="pcard" data-type="premium" data-value="450" data-harga="72500"><div class="pcard-rbx">450 Robux</div><div class="pcard-price">Rp 72.500</div></div>
        <div class="pcard pcard-hot" data-type="premium" data-value="1000" data-harga="145000"><div class="pcard-rbx">1000 Robux</div><div class="pcard-price">Rp 145.000</div></div>
        <div class="pcard" data-type="premium" data-value="2200" data-harga="289000"><div class="pcard-rbx">2200 Robux</div><div class="pcard-price">Rp 289.000</div></div>
      </div>

      <div class="slbl-accent">ğŸ’ Paket Robux</div>
      <div class="pgrid" id="gridLoginRobux">
        <div class="pcard" data-type="robux" data-value="240" data-harga="49500"><div class="pcard-rbx">240 Robux</div><div class="pcard-price">Rp 49.500</div></div>
        <div class="pcard" data-type="robux" data-value="320" data-harga="66000"><div class="pcard-rbx">320 Robux</div><div class="pcard-price">Rp 66.000</div></div>
        <div class="pcard pcard-hot" data-type="robux" data-value="500" data-harga="72500"><div class="pcard-rbx">500 Robux</div><div class="pcard-price">Rp 72.500</div></div>
        <div class="pcard" data-type="robux" data-value="1000" data-harga="145000"><div class="pcard-rbx">1000 Robux</div><div class="pcard-price">Rp 145.000</div></div>
        <div class="pcard" data-type="robux" data-value="2000" data-harga="289000"><div class="pcard-rbx">2000 Robux</div><div class="pcard-price">Rp 289.000</div></div>
      </div>

      <div class="presult" style="margin-top:9px;" id="loginPaketInfo">
        <div class="pr-lbl">Rincian Paket</div>
        <div class="pr-val" id="loginPaketInfoVal">â€” Pilih paket di atas â€”</div>
      </div>

      <button class="btn-go" id="btnLoginTopup" style="margin-top:12px;">âš¡ Kirim ke Admin via WhatsApp</button>
    </div>
  </div>

  <!-- â•â• PANEL KOMUNITAS â•â• -->
  <div class="card off" id="panelKomunitas">
    <div class="c-body" style="text-align:center;padding:44px 20px;">
      <div style="font-size:2.2rem;margin-bottom:10px;">ğŸš§</div>
      <div style="font-size:0.9rem;font-weight:800;color:var(--orange);letter-spacing:1px;margin-bottom:6px;">COMING SOON</div>
      <p style="color:var(--g400);font-size:0.82rem;">Fitur ini sedang dalam pengembangan.</p>
    </div>
  </div>

  <!-- â•â• TOP RANK â•â• -->
  <div class="rank-card">
    <div class="rank-head">
      <h3>ğŸ† Top Pembeli DEXBLOX</h3>
      <p>Pelanggan terbaik bulan ini</p>
    </div>
    <div class="rank-list" id="rankList">
      <!-- Diisi JS -->
    </div>
  </div>

  <!-- â•â• TESTIMONIAL â•â• -->
  <div style="margin-bottom:6px;">
    <div class="slbl" style="margin-bottom:9px;">â­ Ulasan Pelanggan</div>
    <div class="testi-grid">
      <div class="tcard"><div class="tcard-stars">â˜…â˜…â˜…â˜…â˜…</div><div class="tcard-text">"Cepet banget, tengah malam beli langsung masuk!"</div><div class="tcard-user"><div class="tcard-av" style="background:#1565C0">A</div><div><div class="tcard-name">Arya P.</div><div class="tcard-pkg">1000 Robux</div></div></div></div>
      <div class="tcard"><div class="tcard-stars">â˜…â˜…â˜…â˜…â˜…</div><div class="tcard-text">"Harga termurah se-Indonesia. Udah langganan 2 tahun!"</div><div class="tcard-user"><div class="tcard-av" style="background:#00897B">S</div><div><div class="tcard-name">Sinta D.</div><div class="tcard-pkg">450 Robux</div></div></div></div>
      <div class="tcard"><div class="tcard-stars">â˜…â˜…â˜…â˜…â˜…</div><div class="tcard-text">"CS ramah, masalah kelar dalam 5 menit. Trustworthy!"</div><div class="tcard-user"><div class="tcard-av" style="background:#E65100">R</div><div><div class="tcard-name">Rizky F.</div><div class="tcard-pkg">2200 Robux</div></div></div></div>
      <div class="tcard"><div class="tcard-stars">â˜…â˜…â˜…â˜…â˜…</div><div class="tcard-text">"Bayar DANA, langsung bisa dipakai. Mantul!"</div><div class="tcard-user"><div class="tcard-av" style="background:#AD1457">M</div><div><div class="tcard-name">Melisa P.</div><div class="tcard-pkg">800 Robux</div></div></div></div>
    </div>
  </div>

</div>
<footer><div class="f-logo">DEX<span>BLOX</span></div><p>Â© <span id="fullDate"></span> DEXBLOX Â· Bukan afiliasi resmi Roblox Corporation</p></footer>

<button id="fabAdmin" title="Admin">âš™ï¸</button>
<div class="toast" id="toast"></div>

<!-- â•â• MODAL: PAYMENT â•â• -->
<div class="modal" id="payModal">
  <div class="msheet">
    <div class="mhandle"></div>
    <div class="mhead">
      <h3>ğŸ§¾ Konfirmasi Pembayaran</h3>
      <button class="mbtn-x" onclick="closePayModal()">âœ•</button>
    </div>
    <div class="mbody">
      <div class="oid-box">
        <div class="oid-lbl">ID Pesanan</div>
        <div class="oid-code" id="modalOrderId">DBX-XXXXXXX</div>
        <button class="oid-copy" onclick="copyOid()">ğŸ“‹ Salin ID</button>
      </div>
      <div class="osum">
        <div class="osum-row"><span class="os-l">Username</span><span class="os-r" id="sumUser">â€”</span></div>
        <div class="osum-row"><span class="os-l">Paket</span><span class="os-r blue" id="sumPaket">â€”</span></div>
        <div class="osum-row"><span class="os-l">Jenis</span><span class="os-r" id="sumJenis">â€”</span></div>
        <div class="osum-row"><span class="os-l">Harga Paket</span><span class="os-r" id="sumHarga">â€”</span></div>
        <div class="osum-row"><span class="os-l">Biaya Admin QRIS</span><span class="os-r fee">+ Rp 200</span></div>
        <div class="osum-row"><span class="os-l" style="font-weight:700;color:var(--blue);">Total Bayar</span><span class="os-r total" id="sumTotal">â€”</span></div>
      </div>
      <div class="qris-wrap">
        <h4>ğŸ“± Scan QRIS untuk membayar</h4>
        <div class="qris-frame"><img src="qris.png" alt="QRIS" onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22170%22 height=%22170%22%3E%3Crect width=%22170%22 height=%22170%22 fill=%22%23f1f5f9%22 rx=%228%22/%3E%3Ctext x=%2285%22 y=%2278%22 font-size=%2211%22 text-anchor=%22middle%22 fill=%22%2394a3b8%22%3EQRIS tidak tersedia%3C/text%3E%3Ctext x=%2285%22 y=%2296%22 font-size=%2211%22 text-anchor=%22middle%22 fill=%22%2394a3b8%22%3EUpload file qris.png%3C/text%3E%3C/svg%3E'"></div>
        <div class="qris-apps"><span class="qapp">GoPay</span><span class="qapp">OVO</span><span class="qapp">DANA</span><span class="qapp">ShopeePay</span><span class="qapp">m-BCA</span></div>
      </div>
      <div class="due-box">
        <div class="due-lbl">Total yang harus dibayar</div>
        <div class="due-amt" id="dueAmt">Rp â€”</div>
        <div class="due-note">Sudah termasuk biaya admin QRIS Rp 200</div>
      </div>
      <label class="upload-zone">
        <input type="file" id="buktiUpload" accept="image/png,image/jpeg" onchange="previewUp(this)">
        <div class="uz-ico">ğŸ“</div>
        <div class="uz-txt">Upload Bukti Pembayaran</div>
        <div class="uz-sub">JPG/PNG Â· Maks 5MB</div>
      </label>
      <img id="uploadPreview" src="" alt="Preview">
      <div class="act-btns">
        <button class="btn-wa" id="btnConfirmWA">âœ… Sudah Membayar</button>
        <button class="btn-cancel2" onclick="closePayModal()">Batal</button>
      </div>
    </div>
  </div>
</div>

<!-- â•â• MODAL: CEK PESANAN â•â• -->
<div class="modal" id="trackModal">
  <div class="msheet">
    <div class="mhandle"></div>
    <div class="mhead">
      <h3>ğŸ“¦ Lacak Pesanan</h3>
      <button class="mbtn-x" onclick="closeTrack()">âœ•</button>
    </div>
    <div class="mbody">
      <div class="track-row">
        <input class="finput" type="text" id="trackInput" placeholder="Contoh: DBX-A3KW9PJ" style="text-transform:uppercase;">
        <button class="btn-track" onclick="searchOrder()">Cari</button>
      </div>
      <div class="track-res" id="trackRes"></div>
      <div id="recentBox">
        <div class="recv-title">Riwayat Pesanan Sesi Ini</div>
        <div class="olist" id="orderList"><div class="no-ord"><div class="ni">ğŸ“­</div><p>Belum ada pesanan.</p></div></div>
      </div>
    </div>
  </div>
</div>

<!-- â•â• MODAL: ADMIN â•â• -->
<div class="admin-modal" id="adminModal">
  <div class="admin-box">
    <div class="admin-hd">
      <div class="admin-hd-icon">âš™ï¸</div>
      <h3>Admin Panel</h3>
      <button class="mbtn-x" onclick="document.getElementById('adminModal').classList.remove('on')">âœ•</button>
    </div>
    <div class="frow">
      <label class="flabel">Password Admin</label>
      <input class="finput" type="password" id="adminPassword" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
    </div>
    <div style="display:flex;gap:8px;">
      <button class="btn-go" id="btnLoginAdmin" style="margin-top:0;flex:1;">Masuk</button>
      <button onclick="document.getElementById('adminModal').classList.remove('on')" style="flex:1;padding:12px;border-radius:var(--rs);background:var(--g100);border:1px solid var(--g200);font-weight:700;cursor:pointer;color:var(--g700);">Tutup</button>
    </div>
    <div id="adminTools">
      <div class="divr"></div>
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
        <span style="font-size:0.82rem;font-weight:700;">Admin Tools</span>
        <button id="btnLogoutAdmin" style="background:var(--g100);border:1px solid var(--g200);padding:4px 12px;border-radius:20px;font-size:0.72rem;font-weight:600;cursor:pointer;color:var(--g500);">Logout</button>
      </div>
      <div class="frow">
        <label class="flabel">Konfirmasi ke Discord</label>
        <input class="finput" type="text" id="adminUser" placeholder="Username Roblox">
        <button class="btn-cek-user" id="btnAdminCekUser" style="margin-top:6px;width:auto;padding:8px 14px;font-size:0.78rem;">ğŸ” Cek User</button>
        <img id="adminAvatar" src="" style="display:none;width:48px;height:48px;border-radius:50%;margin:8px auto 0;border:2px solid var(--blue);object-fit:cover;">
        <div class="ntf" id="adminNotifUser"></div>
      </div>
      <div class="frow">
        <label class="flabel">Jumlah Robux</label>
        <input class="finput" type="text" id="adminRobux" placeholder="Contoh: 1000">
      </div>
      <div class="frow">
        <label class="flabel">Metode Bayar</label>
        <select class="finput" id="adminMetode">
          <option value="">-- Pilih Metode --</option>
          <option>QRIS</option><option>DANA</option><option>GoPay</option><option>OVO</option><option>ShopeePay</option>
        </select>
      </div>
      <button class="btn-go" id="btnKirimBukti" style="margin-top:4px;">ğŸ“¤ Kirim ke Discord</button>
      <div class="divr"></div>
      <div style="font-size:0.7rem;font-weight:700;color:var(--g400);margin-bottom:8px;text-transform:uppercase;letter-spacing:.5px;">Semua Pesanan</div>
      <div id="adminOrderList" style="max-height:220px;overflow-y:auto;"></div>
    </div>
  </div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  CONFIG & STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const ADMIN_WA = "6285362187740";
const WEBHOOK1 = "https://discord.com/api/webhooks/1474701584775643269/c4rhXs0f7Tc4Kk_uaiOBtNuLpftvZmXWccwvU7BwPTNTJ92To8IQKhN_gW0DtXx-UUpU";
const WEBHOOK2 = "https://discord.com/api/webhooks/1475771186964332595/8_cbT64G8_-LcZLgUCN0UiRJWrXQnAbkua1_NE06kNbpax8yUQsc-6uZnOeK2THmiLU7";
const FEE = 200;
let hargaPer100 = parseInt(document.getElementById("hargaHariIni").dataset.harga);
document.getElementById("hargaHariIni").textContent = hargaPer100.toLocaleString("id-ID");
let promoActive = false;
let userProfileUrl = "";
let currentAvatar5 = "";
let currentAvatarLogin = "";
let orders = [];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  TOP RANK DATA
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const topPlayers = [
  { rank:1, username:"letdaisreal",  display:"l**d*i**eal",  robux:45200, totalBeli:38 },
  { rank:2, username:"rioSlebew52",  display:"r**S**b*w52",  robux:38750, totalBeli:31 },
  { rank:3, username:"Kaen3v",       display:"K**n3v",       robux:29300, totalBeli:25 },
  { rank:4, username:"menglistecu",  display:"m**g**s**cu",  robux:21100, totalBeli:19 },
  { rank:5, username:"Roroemess",    display:"R**o**ss",     robux:17640, totalBeli:15 },
];

async function loadTopRank(){
  const container = document.getElementById("rankList");
  // Render skeleton first
  container.innerHTML = topPlayers.map((p,i)=>`
    <div class="rank-item" id="rankItem${i}">
      <div class="rank-num ${i<3?'rn-'+(i+1):'rn-other'}">${p.rank}</div>
      <div class="rank-av-skel"></div>
      <div class="rank-info">
        <div class="rank-name">${p.display}</div>
        <div class="rank-sub">${p.totalBeli} transaksi</div>
      </div>
      <div class="rank-robux">${p.robux.toLocaleString("id-ID")} R$</div>
    </div>`).join("");

  // Load avatars
  for(let i=0; i<topPlayers.length; i++){
    const p = topPlayers[i];
    try{
      const res = await fetch("/api/user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:p.username})});
      const data = await res.json();
      if(res.ok && data.userId){
        const resAv = await fetch(`/api/avatar?userId=${data.userId}`);
        const dataAv = await resAv.json();
        if(resAv.ok && dataAv.avatarUrl){
          const item = document.getElementById(`rankItem${i}`);
          const skel = item.querySelector(".rank-av-skel");
          const img = document.createElement("img");
          img.className = "rank-av";
          img.src = dataAv.avatarUrl;
          img.alt = p.display;
          skel.replaceWith(img);
        }
      }
    }catch(e){ /* keep skeleton if fail */ }
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  HELPERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function genOid(){ const c="ABCDEFGHJKLMNPQRSTUVWXYZ23456789"; let id="DBX-"; for(let i=0;i<7;i++) id+=c[Math.floor(Math.random()*c.length)]; return id; }
function rp(n){ return "Rp "+n.toLocaleString("id-ID"); }
function fmtDate(d){ return d.toLocaleString("id-ID",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}); }
function toast(msg,ms=3000){ const t=document.getElementById("toast"); t.textContent=msg; t.classList.add("on"); setTimeout(()=>t.classList.remove("on"),ms); }
function ntf(id,msg,type="er"){ const el=document.getElementById(id); if(!el)return; el.textContent=msg; el.className="ntf "+(type==="ok"?"ok":"er"); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  TABS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showPanel(id){
  ["panel5hari","panelLogin","panelKomunitas"].forEach(p=>document.getElementById(p).classList.add("off"));
  document.getElementById(id).classList.remove("off");
  ["tab5hari","tabLogin","tabKomunitas"].forEach(t=>document.getElementById(t).classList.remove("on"));
  const m={panel5hari:"tab5hari",panelLogin:"tabLogin",panelKomunitas:"tabKomunitas"};
  document.getElementById(m[id]).classList.add("on");
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  USERNAME CHECK â€” AUTO LOAD AVATAR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let debounce5 = null, debounceL = null;

function setupAutoCheck(inputId, notifId, skelId, resultId, imgId, nameId, subId, onFound){
  const input = document.getElementById(inputId);
  let lastVal = "";
  input.addEventListener("input", function(){
    const val = this.value.trim();
    if(val === lastVal) return;
    lastVal = val;
    // hide result
    document.getElementById(resultId).style.display = "none";
    document.getElementById(skelId).style.display = "none";
    ntf(notifId, "");
    if(val.length < 3) return;
    clearTimeout(input._debounce);
    input._debounce = setTimeout(()=> checkUser(val, notifId, skelId, resultId, imgId, nameId, subId, onFound), 700);
  });
}

async function checkUser(username, notifId, skelId, resultId, imgId, nameId, subId, onFound){
  const skel = document.getElementById(skelId);
  const result = document.getElementById(resultId);
  skel.style.display = "flex";
  result.style.display = "none";
  ntf(notifId, "");
  try{
    const res = await fetch("/api/user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username})});
    const data = await res.json();
    skel.style.display = "none";
    if(res.ok){
      userProfileUrl = data.profileUrl || `https://www.roblox.com/users/profile?username=${encodeURIComponent(username)}`;
      document.getElementById(nameId).textContent = data.name;
      document.getElementById(subId).textContent = `User ID: ${data.userId}`;
      // Load avatar
      try{
        const resAv = await fetch(`/api/avatar?userId=${data.userId}`);
        const dataAv = await resAv.json();
        if(resAv.ok && dataAv.avatarUrl){
          document.getElementById(imgId).src = dataAv.avatarUrl;
          if(onFound) onFound(dataAv.avatarUrl);
        }
      }catch(e){}
      result.style.display = "flex";
      ntf(notifId, "âœ… Akun valid", "ok");
    } else {
      ntf(notifId, "âŒ " + data.error);
    }
  }catch(e){ document.getElementById(skelId).style.display="none"; ntf(notifId,"âŒ Gagal terhubung ke server."); }
}

// Manual cek buttons
document.getElementById("btnCekUser").onclick = ()=>{
  const v = document.getElementById("username").value.trim();
  if(!v){ ntf("notifUsername","Masukkan username Roblox!"); return; }
  checkUser(v,"notifUsername","skel5hari","avResult5hari","avatarPreview","uname5hari","uid5hari",av=>{ currentAvatar5=av; });
};
document.getElementById("btnLoginCekUser").onclick = ()=>{
  const v = document.getElementById("loginUsername").value.trim();
  if(!v){ ntf("loginNotifUser","Masukkan username Roblox!"); return; }
  checkUser(v,"loginNotifUser","skelLogin","avResultLogin","loginAvatar","unameLogin","uidLogin",av=>{ currentAvatarLogin=av; });
};

// Auto-check on typing
setupAutoCheck("username","notifUsername","skel5hari","avResult5hari","avatarPreview","uname5hari","uid5hari",av=>{ currentAvatar5=av; });
setupAutoCheck("loginUsername","loginNotifUser","skelLogin","avResultLogin","loginAvatar","unameLogin","uidLogin",av=>{ currentAvatarLogin=av; });

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  PAKET CARDS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function bindPaket(gridId, infoId, infoValId, mode){
  document.querySelectorAll(`#${gridId} .pcard`).forEach(card=>{
    card.addEventListener("click",()=>{
      const panel=card.closest(".card");
      panel.querySelectorAll(".pcard").forEach(c=>c.classList.remove("on"));
      card.classList.add("on");
      const type=card.dataset.type||"robux";
      const robux=parseInt(card.dataset.value);
      let harga;
      if(mode==="login"){
        harga=parseInt(card.dataset.harga);
        if(promoActive) harga=Math.round(harga*.9);
        document.getElementById(infoId).dataset.value=robux;
        document.getElementById(infoId).dataset.harga=harga;
        document.getElementById(infoValId).textContent=`${type==="premium"?"Premium":"Robux"}: ${robux} Robux Â· ${rp(harga)}`;
      }else{
        harga=Math.round((robux/100)*hargaPer100);
        if(promoActive) harga=Math.round(harga*.9);
        const gp=Math.round((robux/100)*143);
        document.getElementById(infoId).dataset.value=robux;
        document.getElementById(infoId).dataset.harga=harga;
        document.getElementById(infoValId).textContent=`${robux} Robux Â· ${rp(harga)} Â· Gamepass: ${gp}`;
      }
    });
  });
}
bindPaket("grid5hari","paketInfo","paketInfoVal","5hari");
bindPaket("gridLoginPremium","loginPaketInfo","loginPaketInfoVal","login");
bindPaket("gridLoginRobux","loginPaketInfo","loginPaketInfoVal","login");

// Custom robux
document.getElementById("customRobux").addEventListener("input",function(){
  const robux=parseInt(this.value);
  if(!robux||robux<100){ document.getElementById("paketInfoVal").textContent="â€” Pilih paket di atas â€”"; return; }
  document.querySelectorAll("#grid5hari .pcard").forEach(c=>c.classList.remove("on"));
  let harga=Math.round((robux/100)*hargaPer100);
  if(promoActive) harga=Math.round(harga*.9);
  const gp=Math.round((robux/100)*143);
  document.getElementById("paketInfo").dataset.value=robux;
  document.getElementById("paketInfo").dataset.harga=harga;
  document.getElementById("paketInfoVal").textContent=`${robux} Robux Â· ${rp(harga)} Â· Gamepass: ${gp}`;
});

// Promo
document.getElementById("btnPromo").onclick=()=>{
  const input=document.getElementById("promoInput").value.trim().toUpperCase();
  promoActive=(input==="DEX10OFF");
  ntf("notifPromo",promoActive?"âœ… Kode valid! Diskon 10% aktif.":"âŒ Kode promo tidak valid.",promoActive?"ok":"er");
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  PAYMENT MODAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openPayModal(username, paket, robux, harga, jenis, avatarSrc){
  const oid = genOid();
  const total = harga + FEE;
  document.getElementById("modalOrderId").textContent = oid;
  document.getElementById("sumUser").textContent = username;
  document.getElementById("sumPaket").textContent = paket;
  document.getElementById("sumJenis").textContent = jenis==="5hari"?"Robux 5 Hari":"Via Login";
  document.getElementById("sumHarga").textContent = rp(harga);
  document.getElementById("sumTotal").textContent = rp(total);
  document.getElementById("dueAmt").textContent = rp(total);
  document.getElementById("uploadPreview").style.display="none";
  document.getElementById("uploadPreview").src="";
  document.getElementById("buktiUpload").value="";
  document.querySelector(".uz-txt").textContent="Upload Bukti Pembayaran";

  const order={id:oid,username,paket,robux,harga,total,jenis:jenis==="5hari"?"Robux 5 Hari":"Via Login",status:"pending",profileUrl:userProfileUrl,time:new Date().toISOString(),avatarSrc};
  orders.unshift(order);

  document.getElementById("btnConfirmWA").onclick=async()=>{
    const file=document.getElementById("buktiUpload").files[0];
    if(file){
      if(file.size>5*1024*1024){toast("âš ï¸ File terlalu besar!"); return;}
      if(!["image/png","image/jpeg"].includes(file.type)){toast("âš ï¸ Format harus JPG/PNG!"); return;}
      await uploadDiscord(file,username,robux,harga,total,oid,"QRIS");
    }
    const idx=orders.findIndex(o=>o.id===oid);
    if(idx>=0) orders[idx].status="paid";
    sendWA(username,robux,total,oid);
    closePayModal();
  };
  document.getElementById("payModal").classList.add("on");
}
function closePayModal(){ document.getElementById("payModal").classList.remove("on"); }

// 5 Hari submit
document.getElementById("btnTopup5hari").onclick=function(){
  const username=document.getElementById("username").value.trim();
  const info=document.getElementById("paketInfo");
  const robux=parseInt(info.dataset.value||0);
  const harga=parseInt(info.dataset.harga||0);
  const paket=document.getElementById("paketInfoVal").textContent;
  if(!username){ntf("notifUsername","Masukkan username Roblox!"); return;}
  if(!robux){ntf("notifPaket","Pilih atau masukkan paket Robux!"); return;}
  openPayModal(username,paket,robux,harga,"5hari",currentAvatar5);
};

// Login submit â€” hanya WA
document.getElementById("btnLoginTopup").onclick=function(){
  const username=document.getElementById("loginUsername").value.trim();
  const password=document.getElementById("loginPassword").value;
  const info=document.getElementById("loginPaketInfo");
  const robux=parseInt(info.dataset.value||0);
  const harga=parseInt(info.dataset.harga||0);
  const paket=document.getElementById("loginPaketInfoVal").textContent;
  if(!username){ntf("loginNotifUser","Masukkan username Roblox!"); return;}
  if(!password){ntf("loginNotifUser","Masukkan password Roblox!"); return;}
  if(!robux){ntf("loginNotifUser","Pilih paket terlebih dahulu!"); return;}

  // Via Login hanya WA langsung
  const oid=genOid();
  const total=harga+FEE;
  const order={id:oid,username,paket,robux,harga,total,jenis:"Via Login",status:"pending",profileUrl:userProfileUrl,time:new Date().toISOString(),avatarSrc:currentAvatarLogin};
  orders.unshift(order);

  const now=new Date().toLocaleString("id-ID");
  const msg=`Halo Min DEXBLOX, saya mau topup via Login ğŸ”‘\n\nğŸ“‹ ID Pesanan: *${oid}*\nğŸ‘¤ Username: ${username}\nğŸ”’ Password: ${password}\nğŸ’ Paket: ${paket}\nğŸ’° Total (+ fee): ${rp(total)}\nğŸ”— Profil: ${userProfileUrl}\nğŸ• Waktu: ${now}`;
  window.open(`https://wa.me/${ADMIN_WA}?text=${encodeURIComponent(msg)}`,"_blank");
  toast("âœ… Diarahkan ke WhatsApp admin!");
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  DISCORD UPLOAD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function uploadDiscord(file,username,robux,harga,total,oid,metode){
  const fd=new FormData();
  const msg=`# ğŸ’³ Bukti Pembayaran\nğŸ“‹ ID: **${oid}**\nğŸ‘¤ Username: **${username}**\nğŸ’ Robux: **${robux}**\nğŸ’° Harga: ${rp(harga)}\nğŸ’° Total: ${rp(total)}\nğŸ¦ Metode: **${metode}**`;
  fd.append("file",file);
  fd.append("payload_json",JSON.stringify({content:msg}));
  try{ await fetch(WEBHOOK1,{method:"POST",body:fd}); }catch(e){}
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  WA CONFIRM
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function sendWA(username,robux,total,oid){
  const msg=`Halo Min DEXBLOX, saya sudah membayar! ğŸ®\n\nğŸ“‹ ID Pesanan: *${oid}*\nğŸ‘¤ Username: ${username}\nğŸ’ Robux: ${robux}\nğŸ’° Total Dibayar: ${rp(total)}\nğŸ”— Profil: ${userProfileUrl}\nğŸ• Waktu: ${new Date().toLocaleString("id-ID")}`;
  window.open(`https://wa.me/${ADMIN_WA}?text=${encodeURIComponent(msg)}`,"_blank");
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  UPLOAD PREVIEW
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function previewUp(input){
  const file=input.files[0]; if(!file)return;
  const reader=new FileReader();
  reader.onload=e=>{
    const prev=document.getElementById("uploadPreview");
    prev.src=e.target.result; prev.style.display="block";
    document.querySelector(".uz-txt").textContent="âœ… Bukti terpilih";
  };
  reader.readAsDataURL(file);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  COPY ORDER ID
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function copyOid(){
  const id=document.getElementById("modalOrderId").textContent;
  if(navigator.clipboard){
    navigator.clipboard.writeText(id).then(()=>toast("âœ… "+id+" disalin!"));
  }else{
    const el=document.createElement("textarea");el.value=id;document.body.appendChild(el);el.select();document.execCommand("copy");document.body.removeChild(el);toast("âœ… "+id+" disalin!");
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  TRACK MODAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openTrack(){
  document.getElementById("trackModal").classList.add("on");
  renderOrderList();
}
function closeTrack(){ document.getElementById("trackModal").classList.remove("on"); }

function renderOrderList(){
  const el=document.getElementById("orderList");
  if(!orders.length){ el.innerHTML=`<div class="no-ord"><div class="ni">ğŸ“­</div><p>Belum ada pesanan.</p></div>`; return; }
  el.innerHTML=orders.slice(0,10).map(o=>`<div class="oitem" onclick="showODetail('${o.id}')"><div class="oitem-top"><span class="oi-id">${o.id}</span><span class="sbadge ${sClass(o.status)}">${sLabel(o.status)}</span></div><div class="oi-desc">${o.username} Â· ${o.paket}</div><div class="oi-t">${fmtDate(new Date(o.time))}</div></div>`).join("");
}

function sClass(s){return{pending:"sp",paid:"sd",done:"ss",cancel:"sc"}[s]||"sp";}
function sLabel(s){return{pending:"â³ Menunggu",paid:"âœ… Dibayar",done:"ğŸ‰ Selesai",cancel:"âŒ Batal"}[s]||s;}

function showODetail(id){
  const o=orders.find(x=>x.id===id); if(!o)return;
  document.getElementById("trackInput").value=id;
  renderOCard(o);
}
function searchOrder(){
  const q=document.getElementById("trackInput").value.trim().toUpperCase();
  if(!q){ toast("Masukkan ID pesanan"); return; }
  const o=orders.find(x=>x.id===q);
  if(o) renderOCard(o);
  else{ document.getElementById("trackRes").style.display="block"; document.getElementById("trackRes").innerHTML=`<div class="no-ord"><div class="ni">ğŸ”</div><p>Pesanan <strong>${q}</strong> tidak ditemukan.<br><span style="font-size:0.75rem;color:var(--g400)">Hubungi CS via WhatsApp.</span></p></div>`; }
}
function renderOCard(o){
  document.getElementById("trackRes").style.display="block";
  document.getElementById("trackRes").innerHTML=`<div class="oc"><div class="oc-top"><span class="oc-id">${o.id}</span><span class="sbadge ${sClass(o.status)}">${sLabel(o.status)}</span></div><div class="ocd-row"><span class="ocd-k">Username</span><span class="ocd-v">${o.username}</span></div><div class="ocd-row"><span class="ocd-k">Paket</span><span class="ocd-v">${o.paket}</span></div><div class="ocd-row"><span class="ocd-k">Jenis</span><span class="ocd-v">${o.jenis}</span></div><div class="ocd-row"><span class="ocd-k">Harga Paket</span><span class="ocd-v">${rp(o.harga)}</span></div><div class="ocd-row"><span class="ocd-k">Biaya QRIS</span><span class="ocd-v" style="color:var(--orange)">+ Rp 200</span></div><div class="ocd-row"><span class="ocd-k">Total Bayar</span><span class="ocd-v" style="color:var(--blue)">${rp(o.total)}</span></div><div class="ocd-row"><span class="ocd-k">Waktu</span><span class="ocd-v">${fmtDate(new Date(o.time))}</span></div>${o.profileUrl?`<div class="ocd-row"><span class="ocd-k">Profil</span><span class="ocd-v"><a href="${o.profileUrl}" target="_blank" style="color:var(--blue)">Lihat â†’</a></span></div>`:""}</div>`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ADMIN PANEL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.getElementById("fabAdmin").onclick=()=>document.getElementById("adminModal").classList.add("on");
document.getElementById("btnLoginAdmin").onclick=()=>{
  if(document.getElementById("adminPassword").value==="54321"){
    document.getElementById("adminTools").classList.add("on");
    renderAdminOrders();
  }else toast("âŒ Password salah!");
};
document.getElementById("btnLogoutAdmin").onclick=()=>{
  document.getElementById("adminTools").classList.remove("on");
  document.getElementById("adminPassword").value="";
};
document.getElementById("btnAdminCekUser").onclick=async()=>{
  const u=document.getElementById("adminUser").value.trim(); if(!u)return;
  try{
    const res=await fetch("/api/user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:u})});
    const data=await res.json();
    if(res.ok){
      ntf("adminNotifUser","âœ… "+data.name,"ok");
      const resAv=await fetch(`/api/avatar?userId=${data.userId}`);
      const dataAv=await resAv.json();
      if(resAv.ok&&dataAv.avatarUrl){const av=document.getElementById("adminAvatar");av.src=dataAv.avatarUrl;av.style.display="block";}
    }else ntf("adminNotifUser","âŒ "+data.error);
  }catch(e){ntf("adminNotifUser","âŒ Gagal");}
};
document.getElementById("btnKirimBukti").onclick=async()=>{
  const u=document.getElementById("adminUser").value;
  const rbx=document.getElementById("adminRobux").value;
  const met=document.getElementById("adminMetode").value;
  if(!u||!rbx||!met){toast("Lengkapi semua data!"); return;}
  const now=new Date(), fut=new Date(now.getTime()+3*864e5);
  const msg=`# âœ… Konfirmasi Topup\nUsername: ${u}\nPaket: **${rbx}** Robux\nMetode: **${met}**\nWaktu: ${fmtDate(now)}\nEstimasi Selesai: ${fmtDate(fut)}\nProfil: https://www.roblox.com/users/profile?username=${encodeURIComponent(u)}`;
  const fd=new FormData(); fd.append("payload_json",JSON.stringify({content:msg}));
  try{ await fetch(WEBHOOK2,{method:"POST",body:fd}); toast("âœ… Dikirim ke Discord!"); }
  catch(e){ toast("âŒ Gagal kirim Discord"); }
};

function renderAdminOrders(){
  const el=document.getElementById("adminOrderList");
  if(!orders.length){el.innerHTML=`<p style="font-size:0.78rem;color:var(--g400);text-align:center;padding:14px">Belum ada pesanan.</p>`;return;}
  el.innerHTML=orders.map(o=>`<div style="display:flex;justify-content:space-between;align-items:center;padding:8px 10px;background:var(--g50);border-radius:var(--rs);margin-bottom:5px;border:1px solid var(--g200);"><div><div style="font-size:0.72rem;font-weight:700;color:var(--blue);font-family:monospace;">${o.id}</div><div style="font-size:0.7rem;color:var(--g500);">${o.username} Â· ${o.robux} R$</div></div><div style="display:flex;align-items:center;gap:5px;"><span class="sbadge ${sClass(o.status)}">${sLabel(o.status)}</span>${o.status==="paid"?`<button onclick="markDone('${o.id}')" style="background:var(--blue3);color:var(--blue);border:1px solid #C7D9F7;padding:2px 8px;border-radius:20px;font-size:0.65rem;font-weight:700;cursor:pointer;">Selesai</button>`:""}</div></div>`).join("");
}
function markDone(id){ const o=orders.find(x=>x.id===id); if(o){o.status="done";renderAdminOrders();toast("âœ… Pesanan "+id+" selesai!");} }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.getElementById("fullDate").textContent = new Date().getFullYear();
document.getElementById("trackInput").addEventListener("input",function(){ this.value=this.value.toUpperCase(); });
loadTopRank();
</script>
</body>
</html>
