<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>DEXBLOX.ID - Topup Roblox</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      background: #ffffff;
      color: #222;
    }
    header {
      text-align: center;
      padding: 20px;
      background: linear-gradient(90deg, #00bcd4 30%, #00e676 70%);
      color: #fff;
      border-bottom: 2px solid #00bcd4;
    }
    .logo {
      display: block;
      margin: 0 auto 10px;
      width: 120px;
    }
    header h1 {
      font-size: 32px;
      font-weight: 900;
      margin: 0;
    }
    header h2 {
      font-size: 18px;
      font-weight: bold;
      margin: 0;
    }
    .container {
      margin: 20px auto;
      max-width: 800px;
      background: #f9f9f9;
      border: 1px solid #00bcd4;
      border-radius: 10px;
      padding: 20px;
    }
    .panel {
      margin-top: 15px;
      padding-top: 10px;
      border-top: 1px solid #00bcd4;
      opacity: 0;
      transform: translateY(30px);
      animation: fadeInUp 1s ease forwards;
    }
    .panel:nth-child(n) { animation-delay: calc(0.3s * var(--i)); }
    @keyframes fadeInUp {
      to { opacity: 1; transform: translateY(0); }
    }
    .panel h3 { text-align: center; color: #00bcd4; }
    .form-group { text-align: center; }
    input {
      width: 80%;
      margin: 10px auto;
      padding: 10px;
      font-size: 15px;
      border-radius: 6px;
      border: 1px solid #00bcd4;
      background: #fff;
      color: #222;
    }
    button {
      background: #00bcd4;
      color: #fff;
      border: none;
      padding: 10px 20px;
      font-weight: bold;
      border-radius: 6px;
      transition: 0.3s;
    }
    button:hover {
      background: #00e676;
      box-shadow: 0 0 8px #00e676; /* efek neon tipis */
    }
    .avatar {
      border: 2px solid #00bcd4;
      border-radius: 50%;
      box-shadow: 0 0 8px #00e676;
    }
    #alertBox, #gamepassNotif, #topupNotif {
      margin-top: 10px;
      padding: 8px;
      border-radius: 6px;
      font-size: 14px;
      font-weight: bold;
      text-align: center;
      background: #e0f7fa;
      border: 1px solid #00bcd4;
      color: #222;
      display: none;
    }
    .floating-btn {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #00bcd4;
      color: #fff;
      border: none;
      border-radius: 50%;
      width: 45px;
      height: 45px;
      z-index: 3;
    }
    .admin-panel {
      position: fixed;
      top: 70px;
      right: 20px;
      background: #f9f9f9;
      border: 1px solid #00bcd4;
      border-radius: 8px;
      padding: 10px;
      width: 200px;
      display: none;
      z-index: 3;
    }
    /* Gamepass card style */
    #gamepassList li {
      background: #ffffff;
      border: 1px solid #00bcd4;
      border-radius: 8px;
      margin: 8px auto;
      padding: 10px;
      width: 90%;
      color: #222;
      font-size: 14px;
      text-align: center;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    #gamepassList li:hover {
      transform: scale(1.05);
      box-shadow: 0 0 8px #00e676;
    }
    #gamepassList a {
      color: #00bcd4;
      text-decoration: none;
      font-weight: bold;
    }
    #gamepassList a:hover {
      color: #00e676;
      text-shadow: 0 0 5px #00e676;
    }
  </style>
</head>
<body>
  <header>
    <img src="/dexblox.png" alt="Logo Dexblox" class="logo">
    <h1>DEXBLOX.ID</h1>
    <h2>Topup Gamepass Termurah</h2>
  </header>

  <div class="container">
    <div class="panel form-group" style="--i:1">
      <h3>üí∞ Harga Resmi Robux</h3>
      <p id="hargaResmi">Rp110 per Robux (100 Robux / Rp11.000)</p>
    </div>

    <div class="panel form-group" style="--i:2">
      <h3>üë§ Username Roblox</h3>
      <input type="text" id="username" placeholder="Masukkan username Roblox">
      <button onclick="cekUser()">Cek Username</button>
      <div id="alertBox"></div>
      <div id="userInfo"></div>
    </div>

    <div class="panel form-group" style="--i:3">
      <h3>üì¶ Custom Paket Robux</h3>
      <input type="number" id="customRobux" placeholder="Masukkan jumlah Robux" oninput="hitungHarga(); updateRingkasan();">
      <p id="paketInfo"></p>
    </div>

    <div class="panel form-group" style="--i:4">
      <h3>üéÆ Gamepass Resmi</h3>
      <input type="text" id="gamepassLink" placeholder="Tempelkan link Gamepass Roblox">
      <button onclick="tambahGamepass()">Tambah Gamepass</button>
      <div id="gamepassNotif"></div>
      <ul id="gamepassList" style="list-style:none; padding:0;"></ul>
    </div>

    <div class="panel form-group" style="--i:5">
      <h3>üìÑ Ringkasan Pesanan</h3>
      <div id="ringkasanBox" style="font-size:14px; line-height:1.6; background:#ffffff; padding:10px; border-radius:8px; border:1px solid #00bcd4;">
        Username: <span id="ringkasanUsername">-</span><br>
        Jumlah Robux: <span id="ringkasanJumlah">-</span><br>
        Total: <span id="ringkasanTotal">-</span>
      </div>
    </div>

    <div class="panel form-group" style="--i:6">
      <h3>üí≥ Scan QRIS untuk Pembayaran</h3>
      <img src="/qris.png" alt="QRIS Dexblox" style="width:250px; border:2px solid #00bcd4; border-radius:10px; box-shadow:0 0 8px #00e676;">
      <p style="color:#222; font-size:14px; margin-top:10px;">
        Silakan scan QRIS di atas untuk melakukan pembayaran. Setelah itu kirim bukti ke WhatsApp admin.
      </p>
    </div>

    <div class="panel form-group" style="--i:7">
      <h3>üöÄ Konfirmasi Topup</h3>
      <button onclick="konfirmasiWA()">Kirim ke WhatsApp Admin</button>
      <div id="topupNotif">üöÄ Permintaan Topup dikirim ke Admin Dexblox!</div>
    </div>
  </div>

  <!-- Tombol Admin -->
  <button class="floating-btn" onclick="toggleAdmin()">üîë</button>

  <!-- Panel Admin -->
  <div id="adminPanelBox" class="admin-panel">
    <h3 style="margin:0; font-size:14px; color:#00bcd4;">Admin Login</h3>
    <input type="password" id="adminPass" placeholder="Kode admin">
    <button onclick="adminLogin()">Login</button>
    <p id="adminResult"></p>
    <div id="adminPanel" style="display:none; margin-top:8px;">
      <label for="newPrice">Harga/Robux:</label>
      <input type="number" id="newPrice" placeholder="Rp">
      <button onclick="updatePrice()">Update</button>
    </div>
  </div>

<script>
let pricePerRobux = 110;
let currentUserId = null;

async function cekUser() {
  const username = document.getElementById('username').value.trim();
  const alertBox = document.getElementById('alertBox');
  const userInfo = document.getElementById('userInfo');

  if (!username) {
    alertBox.innerText = "‚ö†Ô∏è Username belum diisi!";
    alertBox.style.display = "block";
    setTimeout(() => { alertBox.style.display = "none"; }, 4000);
    userInfo.innerHTML = "";
    return;
  }

  userInfo.innerHTML = "Loading...";
  try {
    // Endpoint lebih stabil: get-by-username
    const res = await fetch(`https://api.roblox.com/users/get-by-username?username=${username}`);
    const data = await res.json();
    if (!data.Id) throw new Error("UserId tidak ditemukan!");
    currentUserId = data.Id;

    const avatarRes = await fetch(`https://thumbnails.roblox.com/v1/users/avatar-headshot?userIds=${currentUserId}&size=150x150&format=Png&isCircular=true`);
    const avatarData = await avatarRes.json();
    const avatarUrl = avatarData.data?.[0]?.imageUrl;

    userInfo.innerHTML = `
      <img src="${avatarUrl}" alt="Avatar" class="avatar" width="100"><br>
      ‚úÖ Username ditemukan: ${username}
    `;
  } catch (err) {
    userInfo.innerHTML = "‚ùå Username tidak ditemukan!";
  }
}

function hitungHarga() {
  const robux = document.getElementById('customRobux').value;
  if (!robux) {
    document.getElementById('paketInfo').innerText = "";
    return;
  }
  const gross = robux * pricePerRobux;
  const setId = Math.round(robux * 1.43);
  document.getElementById('paketInfo').innerText =
    `Harga: Rp${gross.toLocaleString()} | Set ID: ${setId}`;
}

function updateRingkasan() {
  const username = document.getElementById('username').value.trim();
  const robux = document.getElementById('customRobux').value;
  const gross = robux ? robux * pricePerRobux : 0;

  document.getElementById('ringkasanUsername').innerText = username || "-";
  document.getElementById('ringkasanJumlah').innerText = robux || "-";
  document.getElementById('ringkasanTotal').innerText = gross ? `Rp${gross.toLocaleString()}` : "-";
}

function tambahGamepass() {
  const link = document.getElementById('gamepassLink').value.trim();
  const notif = document.getElementById('gamepassNotif');
  if (!link) {
    notif.style.display = "none";
    return;
  }
  const list = document.getElementById('gamepassList');
  const li = document.createElement('li');
  li.innerHTML = `<a href="${link}" target="_blank">üîó ${link}</a>`;
  list.appendChild(li);
  notif.innerText = "‚úÖ Gamepass ditambahkan!";
  notif.style.display = "block";
  setTimeout(() => { notif.style.display = "none"; }, 3000);
  document.getElementById('gamepassLink').value = "";
}

function konfirmasiWA() {
  const username = document.getElementById('username').value.trim();
  const robux = document.getElementById('customRobux').value;
  if (!username || !robux) {
    alert("‚ö†Ô∏è Lengkapi username dan jumlah Robux!");
    return;
  }

  const gross = robux * pricePerRobux;
  const setId = Math.round(robux * 1.43);

  const message = `Halo Admin Dexblox,
Topup ${robux} Robux (Rp${gross.toLocaleString()}) untuk ${username} via QRIS.
Set ID: ${setId}
Bukti pembayaran: sudah dikirim user.`;

  const phone = "6285362187740"; // nomor admin
  const waUrl = `https://wa.me/${phone}?text=${encodeURIComponent(message)}`;
  window.open(waUrl, "_blank");

  const notif = document.getElementById('topupNotif');
  notif.style.display = "block";
  setTimeout(() => { notif.style.display = "none"; }, 4000);
}

function toggleAdmin() {
  const panel = document.getElementById('adminPanelBox');
  panel.style.display = panel.style.display === "none" ? "block" : "none";
}

function adminLogin() {
  const pass = document.getElementById('adminPass').value;
  const result = document.getElementById('adminResult');
  if (pass === "dexblox123") {
    result.innerText = "‚úÖ Login sukses!";
    document.getElementById('adminPanel').style.display = "block";
  } else {
    result.innerText = "‚ùå Kode salah!";
  }
}

function updatePrice() {
  const newPrice = document.getElementById('newPrice').value;
  if (!newPrice) return;
  pricePerRobux = parseInt(newPrice);
  document.getElementById('hargaResmi').innerText =
    `Rp${pricePerRobux} per Robux (100 Robux / Rp${(pricePerRobux*100).toLocaleString()})`;
  alert("‚úÖ Harga berhasil diupdate!");
  updateRingkasan();
}
</script>
</body>
  </html>
