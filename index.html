<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>DEXBLOX.ID - Topup Roblox</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Font Montserrat -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;900&display=swap" rel="stylesheet">
  <style>
    body {
      margin:0; padding:0;
      font-family: Arial, sans-serif;
      background:#000; color:#fff;
      position:relative; z-index:0;
    }
    header {
      display:flex; justify-content:space-between; align-items:center;
      padding:15px; border-bottom:1px solid rgba(255,255,255,0.2);
      position:relative; z-index:2;
    }
    header h1 {
      font-family: 'Montserrat', sans-serif;
      font-size:32px; font-weight:900;
      color:#fff;
      text-shadow:0 0 10px #0f0, 0 0 15px #fff;
      margin:0; letter-spacing:2px;
    }
    .menu-btn {
      background:none; border:none; font-size:26px; cursor:pointer; color:#fff;
    }
    .container {
      margin:20px; padding:15px;
      background:rgba(255,255,255,0.15);
      border:1px solid rgba(255,255,255,0.3);
      border-radius:10px;
      box-shadow:0 0 15px rgba(0,255,100,0.3);
      backdrop-filter: blur(8px);
      position:relative; z-index:2;
    }
    .panel {margin-top:15px; padding-top:10px; border-top:1px solid rgba(255,255,255,0.2);}
    .panel h3 {font-size:18px; margin-bottom:10px; text-align:center; color:#0f0;}
    .form-group {text-align:center;}
    input,button,select {
      width:80%; margin:10px auto; padding:10px; font-size:15px;
      border-radius:6px; display:block;
    }
    input,select {
      border:1px solid rgba(255,255,255,0.4);
      background:rgba(0,0,0,0.4); color:#fff;
    }
    button {
      background:#25D366; color:#fff; border:none; cursor:pointer;
      transition:0.3s;
    }
    button:hover {background:#128C7E; box-shadow:0 0 8px #0f0;}
    .info-box {
      background:rgba(0,255,100,0.2);
      border:1px solid rgba(0,255,100,0.5);
      border-radius:6px;
      padding:10px; margin-bottom:15px;
      text-align:center; font-size:15px; color:#fff; font-weight:bold;
      backdrop-filter: blur(6px);
    }
    .aurora-greenwhite {
      position:fixed; top:0; left:0;
      width:100%; height:100%;
      background: radial-gradient(circle at 20% 30%, rgba(255,255,255,0.4), transparent 60%),
                  radial-gradient(circle at 80% 70%, rgba(0,255,100,0.3), transparent 60%),
                  radial-gradient(circle at 50% 50%, rgba(0,200,150,0.25), transparent 70%);
      animation: auroraMove 15s ease-in-out infinite alternate;
      z-index:1; opacity:0.8;
    }
    @keyframes auroraMove {
      0%   { background-position: 0% 0%; }
      50%  { background-position: 100% 50%; }
      100% { background-position: 0% 100%; }
    }
    img.avatar {margin-top:10px; border-radius:6px; max-width:100%;}
    /* Admin Modal kecil di pojok kanan atas */
    .modal {
      display:none;
      position:fixed;
      top:60px; right:15px;
      background:rgba(255,255,255,0.9);
      border:1px solid #ccc;
      border-radius:6px;
      padding:8px;
      width:180px;
      box-shadow:0 0 8px rgba(0,0,0,0.3);
      z-index:1000;
      backdrop-filter: blur(6px);
      color:#000;
      font-size:13px;
    }
    .modal h3 {
      margin-top:0;
      font-size:14px;
      color:#007BFF;
      text-align:center;
    }
    .close-btn {
      background:#ff4d4d;
      color:#fff;
      border:none;
      padding:4px 8px;
      border-radius:4px;
      cursor:pointer;
      margin-top:6px;
      font-size:12px;
    }
  </style>
</head>
<body>
  <div class="aurora-greenwhite"></div>
  <header>
    <h1>DEXBLOX.ID</h1>
    <button class="menu-btn" onclick="toggleAdmin()">â‹®</button>
  </header>

  <div class="container">
    <div class="info-box">ðŸ’° Harga Resmi: Rp110 per Robux (100 Robux = Rp11.000)</div>

    <!-- Panel Cek Username -->
    <div class="panel form-group">
      <h3>ðŸ‘¤ Cek Username</h3>
      <input type="text" id="username" placeholder="Masukkan username Roblox">
      <button onclick="cekUser()">Cek Username</button>
      <div id="userInfo"></div>
    </div>

    <!-- Panel Custom Robux -->
    <div class="panel form-group">
      <h3>ðŸ“¦ Custom Paket Robux</h3>
      <input type="number" id="customRobux" placeholder="Masukkan jumlah Robux">
      <button onclick="hitungHarga()">Hitung Harga</button>
      <p id="paketInfo"></p>
    </div>

    <!-- Panel Pembayaran -->
    <div class="panel form-group">
      <h3>ðŸ’³ Pembayaran</h3>
      <select id="payment">
        <option value="gopay">GoPay</option>
        <option value="ovo">OVO</option>
        <option value="dana">DANA</option>
        <option value="qris">QRIS</option>
      </select>
      <button onclick="topup()">Topup Sekarang</button>
    </div>
  </div>

  <!-- Admin Modal -->
  <div id="adminModal" class="modal">
    <h3>ðŸ”‘ Admin</h3>
    <input type="text" id="adminUser" placeholder="User">
    <input type="password" id="adminPass" placeholder="Pass">
    <button onclick="adminLogin()">Login</button>
    <p id="adminResult"></p>
    <div id="adminPanel" style="display:none;">
      <label for="newPrice">Harga/Robux:</label>
      <input type="number" id="newPrice" placeholder="Rp">
      <button onclick="updatePrice()">Update</button>
    </div>
    <button class="close-btn" onclick="toggleAdmin()">Tutup</button>
  </div>

<script>
  let base = "https://dexblox.vercel.app/api"; 
  let currentUserId = null;
  let pricePerRobux = 110;

  function toggleAdmin() {
    const modal = document.getElementById('adminModal');
    modal.style.display = (modal.style.display === "block") ? "none" : "block";
  }

  async function cekUser() {
    const username = document.getElementById('username').value.trim();
    if (!username) return alert("Isi dulu username!");
    const userInfo = document.getElementById('userInfo');
    userInfo.innerHTML = "Loading...";

    try {
      const res = await fetch(`${base}/user?username=${username}`);
      const data = await res.json();
      const userId = data.Id || data.id || data.data?.[0]?.id;
      if (!userId) throw new Error("UserId tidak ditemukan!");
      currentUserId = userId;

      const avatarRes = await fetch(`${base}/avatar?userId=${userId}`);
      const avatarData = await avatarRes.json();
      const avatarUrl = avatarData.imageUrl || avatarData.data?.[0]?.imageUrl;

      userInfo.innerHTML = `
        <p>âœ… Username valid: <b>${username}</b> (UserId: ${userId})</p>
        ${avatarUrl ? `<img class="avatar" src="${avatarUrl}" width="120">` : `<p>Avatar tidak ditemukan.</p>`}
      `;
    } catch (err) {
      userInfo.innerHTML = `<p style="color:red;">Error: ${err.message}</p>`;
    }
  }

  function hitungHarga() {
    const robux = parseInt(document.getElementById('customRobux').value);
    if (!robux || robux <= 0) {
      document.getElementById('paketInfo').innerText = "âŒ Masukkan jumlah Robux yang valid!";
      return;
    }

    const gross = robux * pricePerRobux;
    const setId = Math.round(robux * 1.43);

    document.getElementById('paketInfo').innerText =
      `ðŸ“¦ Paket: ${robux} Robux 
       | ðŸ’° Harga User: Rp${gross.toLocaleString()} 
       | ðŸ”‘ Set ID: ${setId}`;
  }

  function topup() {
    const username = document.getElementById('username').value.trim();
    const robux = document.getElementById('customRobux').value;
    const payment = document.getElementById('payment').value;
    if (!currentUserId) return alert("Cek username dulu sebelum topup!");
    if (!robux) return alert("Isi jumlah Robux dulu!");

    const gross = robux * pricePerRobux;
    const setId = Math.round(robux * 1.43);
    const message = `Halo Admin Dexblox, saya ingin topup ${robux} Robux (Rp${gross.toLocaleString()}) untuk username ${username} via ${payment}. (Set ID: ${setId})`;
    const phone = "6285362187740"; 
    const waUrl = `https://wa.me/${phone}?text=${encodeURIComponent(message)}`;
    window.open(waUrl, "_blank");
  }

  function adminLogin() {
    const user = document.getElementById('adminUser').value;
    const pass = document.getElementById('adminPass').value;
    if (user === "admin" && pass === "12345") {
      document.getElementById('adminResult').innerText = "âœ… Login berhasil. Selamat datang Admin!";
      document.getElementById('adminPanel').style.display = "block";
    } else {
      document.getElementById('adminResult').innerText = "âŒ Login gagal.";
    }
  }

  function updatePrice() {
    const newPrice = parseInt(document.getElementById('newPrice').value);
    if (!newPrice || newPrice <= 0) {
      alert("Isi harga baru per Robux!");
      return;
    }
    pricePerRobux = newPrice;

    document.querySelector(".info-box").innerText =
      `ðŸ’° Harga Resmi: Rp${pricePerRobux} per Robux (100 Robux = Rp${100*pricePerRobux})`;

    document.getElementById('adminResult').innerText =
      `âœ… Harga per Robux diupdate jadi Rp${pricePerRobux.toLocaleString()}`;

    hitungHarga();
  }
</script>
</body>
</html>
